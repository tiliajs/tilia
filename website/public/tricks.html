<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- SEO -->
  <!-- Primary Meta Tags -->
  <title>Tilia Tips and tricks</title>
  <meta name="title" content="Tilia Tips and Tricks">
  <meta name="description" content="Tips and tricks to help code with tilia.">
  <meta name="keywords" content="tilia tips and tricks">
  <meta name="author" content="Tilia Team">
  <meta name="robots" content="index, follow">

  <!-- Canonical URL -->
  <link rel="canonical" href="https://tiliajs.com/tricks">

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://tiliajs.com/tricks">
  <meta property="og:title" content="Tilia Tips and Tricks">
  <meta property="og:description" content="Tips and tricks for tilia state management.">
  <meta property="og:image" content="https://tiliajs.com/logo.svg">
  <meta property="og:site_name" content="Tilia">
  <meta property="article:author" content="Tilia Team">
  <meta property="article:published_time" content="2025-05-24T00:00:00Z">
  <meta property="article:modified_time" content="2025-05-24T00:00:00Z">
  <meta property="article:section" content="Documentation">
  <meta property="article:tag" content="State Management">
  <meta property="article:tag" content="TypeScript">
  <meta property="article:tag" content="ReScript">

  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://tiliajs.com/docs">
  <meta property="twitter:title" content="Tilia Tips and Tricks">
  <meta property="twitter:description" content="Tilia tricks and examples.">
  <meta property="twitter:image" content="https://tiliajs.com/logo.svg">

  <!-- Additional SEO -->
  <meta name="theme-color" content="#8B5CF6">
  <link rel="icon" type="image/svg+xml" href="/logo.svg">
  <link rel="apple-touch-icon" href="/logo.svg">

  <!-- JSON-LD Schema for Documentation -->
  <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "TechArticle",
  "headline": "Tilia Tips and Tricks",
  "description": "Tricks and examples on how to use tilia state management.",
  "url": "https://tiliajs.com/tricks",
  "datePublished": "2025-05-24",
  "dateModified": "2025-05-24",
  "author": {
    "@type": "Organization",
    "name": "Tilia Team"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Tilia"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://tiliajs.com/tricks"
  },
  "about": {
    "@type": "SoftwareApplication",
    "name": "Tilia"
  }
}
</script>
  <!-- end SEO -->
  <link rel="stylesheet" href="./styles.css" />
  <link rel="stylesheet" href="./prism-shades.css" />
  <script>
    let lang = 'rescript'
    function toggleLang() {
      document.querySelectorAll(`code[class*="language-${lang}"]`).forEach(el => el.classList.add('hidden'))
      lang = lang === 'typescript' ? 'rescript' : 'typescript'
      document.querySelectorAll(`code[class*="language-${lang}"]`).forEach(el =>
        el.classList.remove('hidden')
      )
      document.querySelectorAll('.toggle').forEach(toggle => {
        if (lang === 'typescript') {
          toggle.innerHTML = `<strong class="text-white">ts</strong> | res`
        } else {
          toggle.innerHTML = `ts | <strong class="text-white">res</strong>`
        }
      })
    }
    function addToggle() {
      document.querySelectorAll('pre').forEach(pre => {
        if (pre.querySelector('code[class*="language-rescript"]')) {
          const toggle = document.createElement('button')
          toggle.innerText = 'ts | res'
          toggle.classList.add('toggle', 'absolute', 'right-0', 'top-0', 'p-2', 'rounded-tr-xl', 'rounded-bl-xl', 'bg-gray-800', 'text-gray-600', 'hover:bg-gray-700', 'text-sm')
          toggle.addEventListener('click', () => {
            toggleLang()
          })
          pre.style.position = 'relative'
          pre.appendChild(toggle)
        }
      })
    }
  </script>
  <title>Tilia Documentation - Simple State Management</title>
</head>

<body class="bg-gradient-to-br from-cyan-900 via-yellow-900 to-green-800 text-white min-h-screen">
  <nav class="p-6 flex justify-between items-center bg-black/20 sticky top-0 z-50 backdrop-blur-lg">
    <div class="flex items-center space-x-4">
      <a href="/">
        <img src="./logo.svg" alt="Tilia Logo" class="w-10 h-10">
      </a>
      <h1 class="text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-300 to-green-300">
        <a href="/">
          tilia
        </a>
      </h1>
    </div>
    <div class="space-x-6 text-sm font-medium">
      <a href="./" class="hover:text-amber-200/80 transition-colors">Home</a>
      <a href="/docs" class="hover:text-amber-200/80 transition-colors">Docs</a>
      <a href="https://github.com/tiliajs/tilia" class="hover:text-amber-200/80 transition-colors">GitHub</a>
      <a href="/todo-app-ts/" class="hover:text-amber-200/80 transition-colors">Todo App</a>
    </div>
  </nav>

  <main class="container mx-auto px-6 py-8 max-w-4xl">
    <!-- Header -->
    <section class="text-center mb-16">
      <h1 class="text-5xl font-black text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-pink-600 mb-6">
        Tips and tricks
      </h1>
      <p class="text-xl text-white/80 max-w-2xl mx-auto">
        Complete guide to using Tilia for simple and fast state management in TypeScript and ReScript applications.
      </p>
    </section>


    <!-- Tips and tricks -->
    <section class="space-y-12">
      <!-- mutating during render -->
      <div class="bg-white/10 backdrop-blur-lg rounded-xl md:p-8 p-4 border border-white/20">
        <h3 class="text-2xl font-bold mb-4 text-pink-200/90">
          mutating during render <span class="text-lg text-pink-300/60">(is <code class="text-yellow-300/80">sort</code>
            of
            bad)</span>
        </h3>
        <p class="text-lg mb-6 text-white/90">
          Mutating during render should be (probably) be avoided because it can lead to infinite loops: the component
          renders, the render phase ends, the watched data for the component is seen as changed, the render phase starts
          again, and so on.
        </p>

        <p class="text-lg mb-6 text-white/90">
          In the code here, the <code class="text-yellow-300">sort</code> function mutates
          the array in place which
          means that the component is making
          updates to the array itself while rendering.
        </p>

        <pre
          class="mt-2 text-sm md:text-base p-4 rounded-lg backdrop-blur-lg border border-white/20 shadow-2xl relative"><code class="language-typescript">function MyBadList() {
  useTilia();

  return (
    &lt;div&gt;
      &lt;ul&gt;
        { 
          app.list
           // ⬇️ 💥 this mutates the array
            .sort((a, b) => a.name.localeCompare(b.name))
            .map((project) => (
              &lt;li key={project.id}&gt;{project.name}&lt;/li&gt;
            ))
        }
      &lt;/ul&gt;
    &lt;/div&gt;
  )
}
</code><code class="language-rescript hidden">open TiliaReact

  TODO TODO
</code></pre>
        <p class="my-4 text-lg text-white/80">
          Instead, you can either use a quick fix like this:
        </p>
        <pre
          class="my-2 text-sm md:text-base p-4 rounded-lg backdrop-blur-lg border border-white/20 shadow-2xl relative"><code class="language-typescript">function MyOkList() {
  useTilia();

  return (
    &lt;div&gt;
      &lt;ul&gt;
        { 
          [...app.list]
          // ⬇️ now the sort is done in a copy of the array
            .sort((a, b) => a.name.localeCompare(b.name))
            .map((project) => (
              &lt;li key={project.id}&gt;{project.name}&lt;/li&gt;
            ))
        }
      &lt;/ul&gt;
    &lt;/div&gt;
  )
}
</code><code class="language-rescript hidden">open TiliaReact

  TODO TODO
</code></pre>
        <p class="my-4 text-lg text-white/80">
          Or use a derived array to cache the sorted list.
        </p>
        <pre
          class="my-2 text-sm md:text-base p-4 rounded-lg backdrop-blur-lg border border-white/20 shadow-2xl relative"><code class="language-typescript">import { derived } from "tilia";

const sortedList = derived(() =>
  [...app.list].sort((a, b) => a.name.localeCompare(b.name))
);
            
function MyGreatList() {
  useTilia();

  return (
    &lt;div&gt;
      &lt;ul&gt;
        { 
          // ⬇️ ✅ Now the sort is only computed when needed
          sortedList.value.map((project) => (
              &lt;li key={project.id}&gt;{project.name}&lt;/li&gt;
            ))
        }
      &lt;/ul&gt;
    &lt;/div&gt;
  )
}
</code><code class="language-rescript hidden">open TiliaReact

TODO TODO
</code></pre>

        <!-- mutating during render -->
      </div>

      <!-- forgeting to call useTilia -->
      <div class="bg-white/10 backdrop-blur-lg rounded-xl md:p-8 p-4 border border-white/20">
        <h3 class="text-2xl font-bold mb-4 text-cyan-200/80">
          Forgeting to call <span class="text-yellow-200/70">useTilia</span> inside components
        </h3>
        <p class="text-lg mb-6 text-white/90">
          <span class="text-yellow-300/90">useTilia</span> sets which component is the current observer. If we forget to
          call it, the component will not be
          re-rendered on state changes.
        </p>
        <p class="text-lg mb-6 text-white/90">
          State read by an untracked component will be recorded in the last tracked component. If this last component is
          an ancestor, this will work fine (but with excessive rendering of the ancestor instead of just the child).
        </p>

        <pre
          class="mt-2 text-sm md:text-base p-4 rounded-lg backdrop-blur-lg border border-white/20 shadow-2xl relative"><code class="language-typescript">function ParentComponent() {
  useTilia();

  return &lt;WeirdChildComponent toy={app.child.toy} /&gt;;
}

function WeirdChildComponent({ toy }: { toy: Toy }) {
 // ⬅️ (maybe) Bad 🌧️
  return &lt;div&gt;I like to play with {toy.name}&lt;/div&gt;;
}
</code><code class="language-rescript hidden">open TiliaReact

  TODO TODO
</code></pre>
        <p class="my-4 text-lg text-white/80">
          We did not call <span class="text-yellow-200/80">useTilia</span> and <code>toy.name</code> is now watched by
          the parent. On <code>toy.name</code> change, the parent (and the child) will re-render.
        </p>
        <p class="my-4 text-lg text-white/80">
          But if the last tracked component is a sibling, the child's value will be "stuck".
        </p>
        <pre
          class="my-2 text-sm md:text-base p-4 rounded-lg backdrop-blur-lg border border-white/20 shadow-2xl relative"><code class="language-typescript">function ParentComponent() {
  useTilia(); // ⬅️ Good ✅

  return (
    &lt;&gt;
      &lt;GoodAlice toy={app.alice.toy} /&gt;;
      &lt;BadTina toy={app.tina.toy} /&gt;;
    &lt;/&gt;
  );
}

function GoodAlice({ toy }: { toy: Toy }) {
  useTilia(); // ⬅️ Good ✅

  return &lt;div&gt;I am a good child. I like {toy.name}&lt;/div&gt;;
}

function BadTina({ toy }: { toy: Toy }) {
 // ⬅️ Bad 💥

  return &lt;div&gt;I like to play with {toy.name}&lt;/div&gt;;
}
</code><code class="language-rescript hidden">open TiliaReact

  TODO TODO
</code></pre>
        <p class="my-4 text-lg text-white/80">
          We did not call <span class="text-yellow-200/80">useTilia</span>. Alice is the last observer. On
          <code>app.tina.toy.name</code> change, Alice will
          re-render (once) and Tina will be "stuck" 💥.
        </p>
        <p class="my-4 text-lg text-white/80">
          Make sure to call useTilia at the root of the components that consume
          connected tilia state.
        </p>
        <!-- forgeting to call useTilia -->
      </div>

      <!-- Tips and tricks -->
    </section>

    <!-- Main Features -->
    <section class="mb-16 mt-16">
      <div class="bg-white/10 backdrop-blur-lg rounded-xl md:p-8 p-4 border border-white/20">
        <h2 class="text-3xl font-bold mb-6 text-transparent bg-clip-text bg-gradient-to-r from-green-400 to-blue-500">
          Main Features
        </h2>
        <div class="grid lg:grid-cols-2 lg:gap-6 gap-3">
          <div class="space-y-3">
            <div class="flex items-center space-x-2">
              <span class="text-green-400">✓</span>
              <span class="font-bold text-green-300">Zero dependencies</span>
            </div>
            <div class="flex items-center space-x-2">
              <span class="text-green-400">✓</span>
              <span>Single proxy tracking</span>
            </div>
            <div class="flex items-center space-x-2">
              <span class="text-green-400">✓</span>
              <span>Compatible with ReScript and TypeScript</span>
            </div>
            <div class="flex items-center space-x-2">
              <span class="text-green-400">✓</span>
              <span>Inserted objects are not cloned</span>
            </div>
          </div>
          <div class="space-y-3">
            <div class="flex items-center space-x-2">
              <span class="text-green-400">✓</span>
              <span>Tracking follows moved or copied objects</span>
            </div>
            <div class="flex items-center space-x-2">
              <span class="text-green-400">✓</span>
              <span>Respects readonly or classes</span>
            </div>
            <div class="flex items-center space-x-2">
              <span class="text-green-400">✓</span>
              <span>Leaf-tracking (observe read values only)</span>
            </div>
            <div class="flex items-center space-x-2">
              <span class="text-green-400">✓</span>
              <span>Forest mode: tracking across multiple instances</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Examples -->
    <section class="mb-16">
      <div class="bg-white/10 backdrop-blur-lg rounded-xl md:p-8 p-4 border border-white/20">
        <h2 class="text-3xl font-bold mb-6 text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600">
          Examples
        </h2>
        <div class="space-y-4 text-lg text-white/90">
          <p>
            You can check the <a href="https://github.com/tiliajs/tilia/blob/main/todo-app-ts/src/domain/feature/app.ts"
              class="text-blue-300 hover:text-blue-200 underline">todo app</a>
            for a working example using TypeScript.
          </p>
          <p>
            Look at <a href="https://github.com/tiliajs/tilia/blob/main/tilia/test/Tilia_test.res"
              class="text-blue-300 hover:text-blue-200 underline">tilia tests</a> for working examples using ReScript.
          </p>
        </div>
      </div>
    </section>
  </main>

  <footer class="bg-black/20 py-8 text-center">
    <p class="text-sm text-white/70">
      © 2025 Tilia. Open Source, Open Vibes. 💖
    </p>
  </footer>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://unpkg.com/prismjs/components/prism-rescript.min.js"></script>
  <script src="https://unpkg.com/prismjs/components/prism-typescript.min.js"></script>
  <script src="https://unpkg.com/prismjs/components/prism-bash.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      addToggle();
      toggleLang();
    });
  </script>
  <!-- Privacy compliant tracking -->
  <script defer src="https://cloud.umami.is/script.js" data-website-id="9be4d2d0-7f62-4298-9bf3-98b24b891e62"></script>
</body>

</html>